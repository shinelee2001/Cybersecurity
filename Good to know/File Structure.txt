📌 정리: TXT와 PPTX 인코딩 / 구조 / 뷰어 동작 / 매직넘버
1) TXT 파일은 인코딩 정보가 명시되지 않는다

txt는 단순한 바이트 나열이라 보통 인코딩 정보가 없다.

프로그램들은 다음 순서로 인코딩을 판단한다:

BOM(Byte Order Mark) 확인

OS/에디터 기본 인코딩 적용

추정 알고리즘(heuristics) 사용

그래서 txt 파일이 깨져 보이는 경우가 흔하다.

2) PPTX는 인코딩을 명확히 알 수 있다

pptx는 사실 ZIP 압축 파일이며 내부에 여러 XML 파일들이 들어 있다.

XML은 자신의 인코딩(보통 UTF-8/UTF-16)을 명시할 수 있으므로 확실하다.

OOXML 표준 덕분에 구조와 인코딩 방식이 정해져 있다.

3) PPTX를 텍스트 에디터로 열면 왜 깨질까?

pptx는 ZIP 기반 + 바이너리 파일들(이미지·폰트·미디어)이 포함된다.

텍스트 에디터는 모든 바이트를 텍스트로 억지 변환하려 하기 때문에
ZIP 헤더/압축된 데이터가 의미 없는 글자처럼 보인다.

XML 조각 몇 개만 부분적으로 보이는 이유는 그 부분만 텍스트이기 때문.

4) PPTX 뷰어는 파일을 어떻게 PPTX로 인식하나?
(1) 확장자

.pptx → 파워포인트 프로그램과 연결

(2) 파일 시그니처(매직 넘버) 검사

pptx는 ZIP 기반이므로 처음 4바이트가 항상
PK 03 04 (hex) = 80 75 3 4 (decimal)

이를 보고 “이건 ZIP 구조다”를 파악

(3) ZIP 내부 구조 검사

[Content_Types].xml

_rels/.rels

ppt/ 폴더
이 조합이 있으면 확실하게 pptx임.

(4) OOXML 표준에 따라 해석

XML → 슬라이드, 텍스트, 레이아웃, 스타일, 이미지 배치 등을 정의

.rels → 각 요소의 관계 연결

뷰어는 이를 파싱해 렌더링 트리를 만들고 화면에 그린다.

5) PowerShell로 바이너리 첫 50바이트 출력
Get-Content -Path "파일.pptx" -Encoding Byte -TotalCount 50

6) 매직 넘버 정리

네가 출력한 바이트:

80 75 3 4 ...


→ HEX:

50 4B 03 04


→ 의미:

ZIP Local File Header
therefore PPTX 구조의 정상적인 시작
